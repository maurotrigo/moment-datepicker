// moment-datepicker-b3
// ----------------------------------
// v1.1.4
//
// Copyright (c)2015 Mauro Trigo, CityHeroes.
// Distributed under MIT license

(function(t,e){"use strict";"function"==typeof define&&define.amd?define(["jquery","moment"],function(i,s){return e(t,i,s)}):e(t,t.$,t.moment)})(this,function(t,e,i){"use strict";var s=function(t,s){this.element=e(t),this.autoHide=!0&&s.autoHide!==!1&&this.element.data("datepicker-autohide")!==!1,this.format=s.format||this.element.data("datepicker-format")||i.langData().longDateFormat("L"),this.calendarPlacement=s.calendarPlacement||this.element.data("datepicker-calendarplacement")||"right",this.picker=e(a.template).appendTo(s.container).on({click:e.proxy(this.click,this),mousedown:e.proxy(this.mousedown,this)});var n=s.startDate||this.element.data("datepicker-startdate")||void 0;this.startDate=n?a.parseDate(n,this.format):void 0;var h=s.endDate||this.element.data("datepicker-enddate")||void 0;if(this.endDate=h?a.parseDate(h,this.format):void 0,this.isInput=this.element.is("input"),this.component=!this.isInput&&this.element.is(".date")?this.element.find(".input-group-addon, .add-on"):!1,this.isInput?this.element.on({focus:e.proxy(this.show,this),blur:e.proxy(function(){this._hide(),this.triggerChangeDate()},this),input:e.proxy(function(){this.updateFromValue(!0)},this),keyup:e.proxy(function(t){13==t.keyCode&&this.updateFromValue()},this),click:e.proxy(this.show,this)}):this.component?this.component.on("click",e.proxy(this.show,this)):this.element.on("click",e.proxy(this.show,this)),this.minViewMode=s.minViewMode||this.element.data("datepicker-minviewmode")||0,"string"==typeof this.minViewMode)switch(this.minViewMode){case"months":this.minViewMode=1;break;case"years":this.minViewMode=2;break;default:this.minViewMode=0}if(this.viewMode=s.viewMode||this.element.data("datepicker-viewmode")||0,"string"==typeof this.viewMode)switch(this.viewMode){case"months":this.viewMode=1;break;case"years":this.viewMode=2;break;default:this.viewMode=0}this.startViewMode=this.viewMode,this.weekStart=s.weekStart||this.element.data("datepicker-weekstart")||0,this.weekEnd=0===this.weekStart?6:this.weekStart-1,this.fillDow(),this.fillMonths(),this.setCustomClasses(),this.updateFromValue(),this.showMode(),this.refresh()};s.prototype={constructor:s,get:function(){return this.moment&&this.moment.clone()},getAsText:function(t){var e=this.format;return"[object Array]"===Object.prototype.toString.call(e)&&(e=e[0]),this.moment&&this.moment.format(t||e)||""},show:function(t){this.isInput&&this.element.is(":disabled")||this.element.children("input").is(":disabled")||(this.picker.show(),this.height=this.component&&this.component.outerHeight()||this.element.outerHeight(),this.place(),e(window).on("resize",e.proxy(this.place,this)),t&&(t.stopPropagation(),t.preventDefault()),this.isInput||e(document).on("mousedown",e.proxy(this.hide,this)),this.element.trigger({type:"show"}))},_hide:function(t){function e(){clearTimeout(n),t.target.focus(),s.picker.off("click",e)}function i(){s.hide.apply(s,a),s.picker.off("click",e)}if(!(navigator.userAgent.indexOf("MSIE 8.0")>0))return this.hide.apply(this,arguments);var s=this,a=arguments;this.picker.on("click",e);var n=setTimeout(i,100)},hide:function(){this.picker.hide(),e(window).off("resize",this.place),this.viewMode=this.startViewMode,this.showMode(),this.isInput||e(document).off("mousedown",this.hide),this.refresh(),this.element.trigger({type:"hide"})},refresh:function(){var t=this.getAsText();this.isInput?this.element.prop("value",t).change():(this.component&&this.element.find("input").prop("value",t).change(),this.element.data("date",t).change())},set:function(t,e){this.update(t,e),this.refresh()},place:function(){var t=this.component?this.component:this.element,i=t.offset(),s=parseInt(this.element.parents().filter(function(){var t=e(this).css("z-index");return"auto"!=t&&"0"!=t}).first().css("z-index"))+10;"left"==this.calendarPlacement?this.picker.css({top:i.top+this.height,left:i.left+t[0].offsetWidth-this.picker[0].offsetWidth}):this.picker.css({top:i.top+this.height,left:i.left,zIndex:s})},lastValue:null,triggerChangeDate:function(){var t=this.moment?this.moment.valueOf():null;t!=this.lastValue&&(this.lastValue=t,this.element.trigger({type:"changeDate"})),this.autoHide&&this.hide()},updateFromValue:function(t){this.update(this.isInput?this.element.prop("value"):this.element.data("date"),t)},update:function(t,e){var s=this.moment?this.moment.valueOf():null;this.moment=a.parseDate(t,this.format);var n=this.moment?this.moment.valueOf():null;this.viewDate&&s==n||(this.viewDate=this.get()||i().hours(0).minutes(0).seconds(0).milliseconds(0),this.fill(),this.element.trigger({type:"changeDateInstant"})),e||this.triggerChangeDate()},fillDow:function(){for(var t=this.weekStart,s="<tr>",a=e.proxy(i.langData().weekdaysMin,i.langData());this.weekStart+7>t;)s+='<th class="dow">'+a(i().day(t++%7))+"</th>";s+="</tr>",this.picker.find(".datepicker-days thead").append(s)},fillMonths:function(){for(var t="",s=0,a=e.proxy(i.langData().monthsShort,i.langData());12>s;)t+='<span class="month">'+a(i().startOf("month").month(s++))+"</span>";this.picker.find(".datepicker-months td").append(t)},fill:function(){var t=this.viewDate.year(),e=this.viewDate.month(),s=this.get(),a=s?s.valueOf():null,n=s?s.year():null,h=s?s.month():null;this.picker.find(".datepicker-days th:eq(1)").text(i.langData().months(i().month(e))+" "+t);var o=i([t,e,0]);o.day(o.day()-(o.day()-this.weekStart+7)%7);for(var d,r=i(o).add("days",42).valueOf(),l=[];r>o.valueOf();)o.day()===this.weekStart&&l.push("<tr>"),d="",t>o.year()||o.year()==t&&e>o.month()?d+=" old":(o.year()>t||o.year()==t&&o.month()>e)&&(d+=" new"),o.valueOf()===a&&(d+=" active"),(o.valueOf()<this.startDate||o.valueOf()>this.endDate)&&(d+=" disabled"),l.push('<td class="day'+d+'">'+o.date()+"</td>"),o.day()===this.weekEnd&&l.push("</tr>"),o.add("days",1);this.picker.find(".datepicker-days tbody").empty().append(l.join(""));var c=this.picker.find(".datepicker-months").find("th:eq(1)").text(t).end().find("span").removeClass("active").removeClass("disabled");n===t&&c.eq(h).addClass("active"),(this.startDate&&this.startDate.year()>t||this.endDate&&t>this.endDate.year())&&c.addClass("disabled"),this.startDate&&t==this.startDate.year()&&c.slice(0,this.startDate.month()).addClass("disabled"),this.endDate&&t==this.endDate.year()&&c.slice(this.endDate.month()+1).addClass("disabled"),l="",t=10*parseInt(t/10,10);var p=this.picker.find(".datepicker-years").find("th:eq(1)").text(t+"-"+(t+9)).end().find("td");t-=1;for(var m=-1;11>m;m++)l+='<span class="year'+(-1===m||10===m?" old":"")+(n===t?" active":"")+(this.startDate&&this.startDate.year()>t||this.endDate&&t>this.endDate.year()?" disabled":"")+'">'+t+"</span>",t+=1;p.html(l)},click:function(t){t.stopPropagation(),t.preventDefault();var s=e(t.target).closest("span, td, th");if(1===s.length)switch(s[0].nodeName.toLowerCase()){case"th":switch(s[0].className){case"switch":this.showMode(1);break;case"prev":case"next":var n=a.modes[this.viewMode];this.viewDate.add(n.navFnc,n.navStep*("prev"===s[0].className?-1:1)),this.fill(),this.refresh()}break;case"span":if(!s.is(".disabled")){if(s.is(".month")){var h=s.parent().find("span").index(s);this.viewDate.add("months",h-this.viewDate.month())}else{var o=parseInt(s.text(),10)||0;this.viewDate.year(o)}this.viewMode!==this.minViewMode?(this.showMode(-1),this.set(this.viewDate,!0)):this.set(this.viewDate)}break;case"td":if(!s.is(".disabled")&&s.is(".day")){var d=parseInt(s.text(),10)||1,r=this.viewDate.clone();s.is(".old")?r.startOf("month").add("days",-1):s.is(".new")&&r.endOf("month").add("days",1);var l=r.month(),o=r.year();this.set(i([o,l,d]))}}},dateWithinRange:function(t){return t>=this.startDate&&this.endDate>=t},mousedown:function(t){t.stopPropagation(),t.preventDefault()},showMode:function(t){t&&(this.viewMode=Math.max(this.minViewMode,Math.min(2,this.viewMode+t))),this.picker.find(">div").hide().filter(".datepicker-"+a.modes[this.viewMode].clsName).show()},setCustomClasses:function(){"left"==this.calendarPlacement&&this.picker.addClass("datepicker-left")}},e.fn.datepicker=function(t,i){var a=[],n=this.each(function(){var n=e(this),h=n.data("datepicker"),o="object"==typeof t&&t;if("string"==typeof t){if(h){var d=h[t](i);d!==void 0&&a.push(d)}}else h||n.data("datepicker",h=new s(this,e.extend({},e.fn.datepicker.defaults,o)))});return 1==a.length?a[0]:a.length?a:n},e.fn.datepicker.defaults={container:"body"},e.fn.datepicker.Constructor=s;var a={modes:[{clsName:"days",navFnc:"months",navStep:1},{clsName:"months",navFnc:"years",navStep:1},{clsName:"years",navFnc:"years",navStep:10}],parseDate:function(t,e){var s=null;return"string"==typeof t&&(s="[object Array]"===Object.prototype.toString.call(e)?i(t,e,!0):i(t,e)),s&&s.isValid()||(s=i(t)),s&&s.isValid()?s.hours(0).minutes(0).seconds(0).milliseconds(0):null},headTemplate:'<thead><tr><th class="prev">&lsaquo;</th><th colspan="5" class="switch"></th><th class="next">&rsaquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'};a.template='<div class="datepicker dropdown-menu"><div class="datepicker-days"><table class=" table-condensed">'+a.headTemplate+"<tbody></tbody>"+"</table>"+"</div>"+'<div class="datepicker-months">'+'<table class="table-condensed">'+a.headTemplate+a.contTemplate+"</table>"+"</div>"+'<div class="datepicker-years">'+'<table class="table-condensed">'+a.headTemplate+a.contTemplate+"</table>"+"</div>"+"</div>"});
//@ sourceMappingURL=moment-datepicker.min.map